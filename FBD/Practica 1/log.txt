
SQL> DROP TABLE USUARIOS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE PERFILES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE TIPOS_CONTRATOS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE CONTRATOS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE RATIOS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE IDIOMAS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE CALIFICACIONES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE GENEROS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE IMDBS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE PELICULAS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE PALABRAS_PELICULA CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE GENEROS_PELICULA CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE PROTAGONISTAS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE CLUBES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE MEMBRESIA CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE PROPUESTAS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE CLUBES_HISTORICOS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE MEMBRESIA_HISTORICAS CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE OPINIONES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE INVITACIONES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE SOLICITUDES CASCADE CONSTRAINTS;

Tabla borrada.

SQL> DROP TABLE CREACIONES_CLUB CASCADE CONSTRAINTS;

Tabla borrada.

SQL>
SQL> CREATE TABLE USUARIOS(
  2  nombre_usuario VARCHAR2(100) NOT NULL,
  3  password VARCHAR2(100) NOT NULL,
  4  email VARCHAR2(100) NOT NULL,
  5  CONSTRAINT PKUSUARIOS_nombre_usuario PRIMARY KEY (nombre_usuario),
  6  CONSTRAINT FKUSUARIOS_email UNIQUE(email),
  7  CONSTRAINT password_valid CHECK (password>8)
  8  );

Tabla creada.

SQL>
SQL> CREATE TABLE PERFILES(
  2  dni VARCHAR2(9) NOT NULL,
  3  nombre_pila VARCHAR2(100),
  4  apellido1 VARCHAR2(100),
  5  apellido2 VARCHAR(100),
  6  f_nacimiento DATE,
  7  telf VARCHAR2(14),
  8  edad NUMBER(3),
  9  usuario VARCHAR2(100) NOT NULL,
 10  CONSTRAINT PKPERFILES_dni PRIMARY KEY (dni),
 11  CONSTRAINT  FKPERFILES_perfil_usuario FOREIGN KEY(usuario) REFERENCES USUARIOS(nombre_usuario)
 12  ON DELETE CASCADE
 13  );

Tabla creada.

SQL>
SQL> CREATE TABLE TIPOS_CONTRATOS(
  2  tipo VARCHAR2(100) NOT NULL,
  3  CONSTRAINT PKTIPOSCONTRATOS_tipo PRIMARY KEY (tipo)
  4  );

Tabla creada.

SQL>
SQL> CREATE TABLE CONTRATOS(
  2  id VARCHAR2(100) NOT NULL,
  3  tipo_contrato VARCHAR2(50) NOT NULL,
  4  perfil VARCHAR2(9) NOT NULL,
  5  cod_postal VARCHAR2(10) NOT NULL,
  6  ciudad VARCHAR2(100) NOT NULL,
  7  pais VARCHAR2(100) NOT NULL,
  8  f_inicio DATE NOT NULL,
  9  f_fin DATE,
 10  CONSTRAINT PKCONTRATOS_id PRIMARY KEY (id),
 11  CONSTRAINT FKCONTRATO_contrato_perfil FOREIGN KEY (perfil) REFERENCES PERFILES(DNI),
 12  CONSTRAINT FKCONTRATO_contrato_tipo FOREIGN KEY (tipo_contrato) REFERENCES TIPOS_CONTRATOS(tipo)
 13  );

Tabla creada.

SQL>
SQL> CREATE TABLE RATIOS(
  2  tipo DECIMAL(5) NOT NULL,
  3  CONSTRAINT PKRATIOS_tipo PRIMARY KEY (tipo)
  4  );

Tabla creada.

SQL>
SQL> CREATE TABLE IDIOMAS(
  2  nombre VARCHAR2(100) NOT NULL,
  3  CONSTRAINT PKIDIOMAS_nombre PRIMARY KEY (nombre)
  4  );

Tabla creada.

SQL>
SQL> CREATE TABLE CALIFICACIONES(
  2  tipo VARCHAR2(8) NOT NULL,
  3  CONSTRAINT PKCALIFICACIONES_tipo PRIMARY KEY (tipo)
  4  );

Tabla creada.

SQL>
SQL> CREATE TABLE GENEROS(
  2  tipo VARCHAR2(100) NOT NULL,
  3  CONSTRAINT PKGENEROS_tipo PRIMARY KEY (tipo)
  4  );

Tabla creada.

SQL>
SQL> CREATE TABLE IMDBS(
  2  link VARCHAR2(200) NOT NULL,
  3  puntuacion NUMBER(2) NOT NULL,
  4  cantidad_users NUMBER(25) NOT NULL,
  5  cantidad_criticos NUMBER(20) NOT NULL,
  6  CONSTRAINT PKIMDBS_link PRIMARY KEY (link)
  7  );

Tabla creada.

SQL>
SQL> CREATE TABLE PELICULAS(
  2  titulo VARCHAR2(100) NOT NULL,
  3  director VARCHAR2(100) NOT NULL,
  4  duracion NUMBER(3) NOT NULL,
  5  color VARCHAR2(100) NOT NULL,
  6  ratio DECIMAL(5) NOT NULL,
  7  año_estreno DATE NOT NULL,
  8  calif_edad VARCHAR2(8) NOT NULL,
  9  pais VARCHAR2(100) NOT NULL,
 10  idioma VARCHAR2(100) NOT NULL,
 11  presupuesto NUMBER(30) NOT NULL,
 12  ingresos NUMBER(30) NOT NULL,
 13  imdb VARCHAR2(100) NOT NULL,
 14  n_rostros NUMBER(8) NOT NULL,
 15  l_dir NUMBER(25) NOT NULL,
 16  l_peli NUMBER(25) NOT NULL,
 17  servicio VARCHAR2(100) NOT NULL,
 18  CONSTRAINT PKPELICULAS PRIMARY KEY(titulo, director),
 19  CONSTRAINT CHECKPELICULAS_COLOR CHECK (color IN('Color','Black and White')),
 20  CONSTRAINT FKPELICULAS_RATIO FOREIGN KEY(ratio) REFERENCES RATIOS(tipo),
 21  CONSTRAINT FKPELICULAS_CALIFICACION FOREIGN KEY(calif_edad) REFERENCES CALIFICACIONES(TIPO),
 22  CONSTRAINT FKPELICULAS_IDIOMA FOREIGN KEY(idioma) REFERENCES IDIOMAS(NOMBRE),
 23  CONSTRAINT FKPELICULAS_IMDB FOREIGN KEY(imdb) REFERENCES IMDBS(link),
 24  CONSTRAINT FKPELICULAS_SERVICIO FOREIGN KEY(servicio) REFERENCES TIPOS_CONTRATOS(tipo)
 25  );

Tabla creada.

SQL>
SQL> CREATE TABLE PALABRAS_PELICULA(
  2  pelicula_titulo VARCHAR2(100) NOT NULL,
  3  pelicula_director VARCHAR2(100) NOT NULL,
  4  palabra VARCHAR2(100) NOT NULL,
  5  CONSTRAINT PKPALABRASPELICULA PRIMARY KEY(pelicula_titulo, pelicula_director),
  6  CONSTRAINT FKPALABRASPELICULA_pelicula FOREIGN KEY (pelicula_titulo, pelicula_director) REFERENCES PELICULAS(titulo, director)
  7   ON DELETE CASCADE
  8  );

Tabla creada.

SQL>
SQL> CREATE TABLE GENEROS_PELICULA(
  2  pelicula_titulo VARCHAR2(100) NOT NULL,
  3  pelicula_director VARCHAR(100) NOT NULL,
  4  genero VARCHAR2(100) NOT NULL,
  5  CONSTRAINT PKGENEROSPELICULA PRIMARY KEY(pelicula_titulo, pelicula_director),
  6  CONSTRAINT FKGENEROSPELICULA_pelicula FOREIGN KEY (pelicula_titulo, pelicula_director) REFERENCES PELICULAS(titulo, director)
  7   ON DELETE CASCADE,
  8  CONSTRAINT FKGENEROSPELICULA_genero FOREIGN KEY (genero) REFERENCES GENEROS(tipo)
  9  );

Tabla creada.

SQL>
SQL> CREATE TABLE PROTAGONISTAS(
  2  pelicula_titulo VARCHAR2(100) NOT NULL,
  3  pelicula_director VARCHAR2(100) NOT NULL,
  4  nombre VARCHAR2(50) NOT NULL,
  5  apellido VARCHAR2(50) NOT NULL,
  6  likes NUMBER (25) NOT NULL,
  7  CONSTRAINT PKPROTAGONISTAS PRIMARY KEY(pelicula_titulo, pelicula_director, nombre, apellido),
  8  CONSTRAINT FKPROTAGONISTAS_pelicula FOREIGN KEY (pelicula_titulo, pelicula_director) REFERENCES PELICULAS(titulo, director)
  9  );

Tabla creada.

SQL>
SQL> CREATE TABLE CLUBES(
  2  nombre VARCHAR2(100) NOT NULL,
  3  abierto NUMBER(1) NOT NULL,
  4  ciudad VARCHAR2(50) NOT NULL,
  5  cod_postal VARCHAR2(60) NOT NULL,
  6  pais VARCHAR2(50) NOT NULL,
  7  f_creacion DATE NOT NULL,
  8  CONSTRAINT PKCLUBES_nombre PRIMARY KEY(nombre)
  9  );

Tabla creada.

SQL>
SQL> CREATE TABLE MEMBRESIA(
  2  club VARCHAR2(100) NOT NULL,
  3  usuario VARCHAR2(100) NOT NULL,
  4  media_actividad NUMBER(10) NOT NULL,
  5  CONSTRAINT PKMEMBRESIA PRIMARY KEY(club, usuario),
  6  CONSTRAINT FKMEMBRESIA_club FOREIGN KEY(club) REFERENCES CLUBES(nombre),
  7  CONSTRAINT FKMEMBRESIA_usuario FOREIGN KEY(usuario) REFERENCES USUARIOS(nombre_usuario)
  8  );

Tabla creada.

SQL>
SQL> CREATE TABLE PROPUESTAS(
  2  miembro_club VARCHAR(100) NOT NULL,
  3  miembro_usuario VARCHAR(100) NOT NULL,
  4  pelicula_titulo VARCHAR(100) NOT NULL,
  5  pelicula_director VARCHAR(100) NOT NULL,
  6  f_completa DATE NOT NULL,
  7  aceptado NUMBER(1) NOT NULL,
  8  asunto VARCHAR(100) NOT NULL,
  9  mensaje VARCHAR (1500) NOT NULL,
 10  CONSTRAINT PKPROPUESTAS PRIMARY KEY(miembro_club, miembro_usuario, f_completa),
 11  CONSTRAINT FKPROPUESTAS_miembro FOREIGN KEY(miembro_club, miembro_usuario) REFERENCES MEMBRESIA(club, usuario)
 12   ON DELETE CASCADE,
 13  CONSTRAINT FKPROPUESTAS_peliculas FOREIGN KEY(pelicula_titulo, pelicula_director) REFERENCES PELICULAS(titulo, director)
 14  );

Tabla creada.

SQL>
SQL> CREATE TABLE CLUBES_HISTORICOS(
  2  nombre VARCHAR2(100) NOT NULL,
  3  abierto NUMBER(1) NOT NULL,
  4  ciudad VARCHAR2(50) NOT NULL,
  5  cod_postal VARCHAR2(60) NOT NULL,
  6  pais VARCHAR2(50) NOT NULL,
  7  f_creacion DATE,
  8  f_cierre DATE,
  9  CONSTRAINT PKCLUBES_HISTORICOS_nombre PRIMARY KEY(nombre)
 10  );

Tabla creada.

SQL>
SQL> CREATE TABLE MEMBRESIA_HISTORICAS (
  2  club VARCHAR2(100) NOT NULL,
  3  usuario VARCHAR2(100) NOT NULL,
  4  media_actividad NUMBER(10) NOT NULL,
  5  CONSTRAINT PKMEMBRESIA_HISTORICAS PRIMARY KEY(club, usuario),
  6  CONSTRAINT FKMEMBRESIA_HISTRORICAS_club FOREIGN KEY(club) REFERENCES CLUBES_HISTORICOS(nombre)
  7   ON DELETE CASCADE,
  8  CONSTRAINT FKMEMBRESIA_HISTRORICAS_usuario FOREIGN KEY(usuario) REFERENCES USUARIOS(nombre_usuario)
  9   ON DELETE CASCADE
 10  );

Tabla creada.

SQL>
SQL> CREATE TABLE OPINIONES(
  2  miembro_club VARCHAR2(100) NOT NULL,
  3  miembro_usuario VARCHAR2(100) NOT NULL,
  4  pelicula_titulo VARCHAR2(100) NOT NULL,
  5  pelicula_director VARCHAR2(100) NOT NULL,
  6  f_completa DATE NOT NULL,
  7  asunto VARCHAR2(1500) NOT NULL,
  8  valoracion NUMBER(2),
  9  CONSTRAINT PKOPINIONES_miembro_club PRIMARY KEY (miembro_club, miembro_usuario, pelicula_titulo, pelicula_director),
 10  CONSTRAINT FKOPINIONES_pelicula FOREIGN KEY (pelicula_titulo, pelicula_director) REFERENCES PELICULAS(titulo, director)
 11  ON DELETE CASCADE,
 12  CONSTRAINT FKOPINIONES_miembro FOREIGN KEY (miembro_usuario, miembro_club) REFERENCES MEMBRESIA (usuario, club)
 13  ON DELETE CASCADE
 14  );

Tabla creada.

SQL>
SQL> CREATE TABLE INVITACIONES(
  2  miembro_usuario VARCHAR2(100) NOT NULL,
  3  miembro_club VARCHAR2(100) NOT NULL,
  4  invitado VARCHAR(100) NOT NULL,
  5  f_completa DATE NOT NULL,
  6  aceptado NUMBER(1),
  7  CONSTRAINT PKINVITACIONES PRIMARY KEY (miembro_club, miembro_usuario, invitado),
  8  CONSTRAINT FKINVITACIONES_miembro FOREIGN KEY (miembro_usuario, miembro_club) REFERENCES MEMBRESIA (usuario, club)
  9  ON DELETE CASCADE,
 10  CONSTRAINT FKINVITACIONES_invitado FOREIGN KEY (invitado) REFERENCES USUARIOS (nombre_usuario)
 11  ON DELETE CASCADE
 12  );

Tabla creada.

SQL>
SQL> CREATE TABLE SOLICITUDES(
  2  usuario VARCHAR2(100) NOT NULL,
  3  club varchar2(100) NOT NULL,
  4  f_completa DATE NOT NULL,
  5  aceptado NUMBER(1),
  6  CONSTRAINT PKSOLICITUDES_usuario PRIMARY KEY(usuario, club),
  7  CONSTRAINT FKSOLICITUDES_usuario FOREIGN KEY(usuario) REFERENCES USUARIOS(nombre_usuario)
  8   ON DELETE CASCADE,
  9  CONSTRAINT FKSOLICITUDES_club FOREIGN KEY(club) REFERENCES CLUBES(nombre)
 10   ON DELETE CASCADE
 11  );

Tabla creada.

SQL>
SQL> CREATE TABLE CREACIONES_CLUB (
  2  usuario VARCHAR2(100) NOT NULL,
  3  club VARCHAR2(100) NOT NULL,
  4  f_completa DATE NOT NULL,
  5  CONSTRAINT PKCREACIONESCLUB PRIMARY KEY (usuario, club),
  6  CONSTRAINT FKCREACIONESCLUB_usuario FOREIGN KEY (usuario) REFERENCES USUARIOS(nombre_usuario)
  7  ON DELETE CASCADE,
  8  CONSTRAINT FKCREACIONESCLUB_club FOREIGN KEY (club) REFERENCES CLUBES(nombre)
  9  ON DELETE CASCADE
 10  );

Tabla creada.

SQL>